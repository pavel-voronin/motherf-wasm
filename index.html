<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  </head>
  <body>
    <form id="form">
      <p>
        <textarea name="code" cols="80" rows="10">
>++++++++[<+++++++++>-]<.>++++[<+++++++>-]<+.+++++++..+++.>>++++++[<+++++++>-]<+
+.------------.>++++++[<+++++++++>-]<+.<.+++.------.--------.>>>++++[<++++++++>-
]<+.</textarea
        >
      </p>
      <p>
        <textarea name="input" cols="80" rows="10">a</textarea>
      </p>
      <p><b>Output:</b> <pre id="output"></pre></p>
      <p><b>Error:</b> <pre id="error"></pre></p>
      <p>
        <button type="submit">Run</button>
      </p>
    </form>

    <script type="module">
      import init, { interpret } from "./pkg/motherf_wasm.js";

      async function run() {
        const code = document.getElementsByName("code")[0].value.trim();
        const input = document.getElementsByName("input")[0].value.trim();

        try {
          const result = interpret(code, input);

          document.getElementById("output").innerHTML = result;
        } catch (error) {
          document.getElementById("output").innerHTML = error.message;
        }
      }

      async function initialize() {
        const form = document.getElementById("form");

        form.addEventListener("submit", (e) => {
          run();
          e.preventDefault();
        });

        console.log(await init());
      }

      initialize();
    </script>
  </body>
</html>
